# SecondHand

Backend App for SecondHand

# Demo

[DEV Heroku](https://febesh5-dev.herokuapp.com/)<br>
[PROD Heroku](https://febesh5-dev.herokuapp.com/)

# Instruction before running / start this project (for development)

1. Before installing, please specify database url in .env file (example env file on .env.example)
2. Install all required things, use install.bat (double click it like executable)
    - OR you can just run these command below (sequentially)
    - `npm i --production=false`
    - `npx prisma migrate reset --schema=./models/schema.prisma -f`
    - `npx prisma db pull --schema=./models/schema.prisma`
    - `npx prisma generate --schema=./models/schema.prisma`
    - Installation will take a while, so please be patient.
    - Make sure Installation is successful or done properly.
3. Make sure to edit .env file with yours (environment). See .env.example for example
4. Then you can run with run.bat (double click it like executable), OR you can just do `npm start`

# Instruction before using github CI/CD
1. Go to github repo settings -> Secrets -> Actions
2. Add these variables (key=value)
    - DEV_HEROKU_API_KEY=REPLACE_WITH_YOUR_KEY
    - DEV_HEROKU_APP_NAME=REPLACE_WITH_YOUR_APP_NAME
    - DEV_HEROKU_EMAIL=REPLACE_WITH_YOUR_EMAIL
    - PROD_HEROKU_API_KEY=REPLACE_WITH_YOUR_KEY
    - PROD_HEROKU_APP_NAME=REPLACE_WITH_YOUR_APP_NAME
    - PROD_HEROKU_EMAIL=REPLACE_WITH_YOUR_EMAIL
3. Done, you can now push your code to gitlab and CI/CD runner will run without any problem


# Design Pattern

MVC with Router and auto-generated Models

# Folder Structure

```bash
└── root
    ├── bin/
    ├── controllers/
    │   ├── API/
    │   └── web/
    ├── middlewares/
    │   └── ...your middlewares...
    ├── models/
    │   └── prisma.schema
    ├── public/
    │   ├── ...your statics...
    ├── routes/
    │   ├── api.js
    │   └── index.js
    ├── storage/
    │   └── ...uploaded files...
    ├── tests/
    │   └── ...test files...
    └── views/
        └── ...your views...
```

## Folder Structure Explanation

- bin:
  > contains all the executables (you don't need to touch this folder)
- controllers:
  > contains all the controllers

  > separated by API and web
- middlewares:
  > contains all the middlewares

  > register your middlewares here inside function in index.js
- models:
  > contains all the ORM models (customize yours in prisma.schema)

  > is automatically generated by prisma (see explanation below)
- public:
  > contains all the static files

  > these files are served by the server
- routes:
  > contains all the routes

  > register your API routes in api.js

  > register your web routes in web.js
- tests:
  > contains all the test files (insomnia, jest, etc)
- views:
  > contains all the views

## Prisma auto-generated models explanation

- prisma automatically generates a model for each table in your database when you run `npx prisma pull`
- the model is automatically generated by prisma (depends on your database)
- generated models are stored inside prisma.schema in models folder
- more https://www.prisma.io/docs/getting-started
